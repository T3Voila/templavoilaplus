{namespace core=TYPO3\CMS\Core\ViewHelpers}

<div class="callout">
    <h2 class="text-primary">TemplaVoilà! Plus (TV+)</h2>
    <p class="lead text-primary"><b>Welcome to the Update Script collection to get your DataStructures, Mapping- and TemplateConfigurations updated to the latest state for your running TYPO3 and TV+ version.</b></p>
    <p class="lead">Your system runs TYPO3 {typo3Version} and TV+ {tvpVersion}.
        <f:if condition="{is12orNewer}">
            <span class="text-warning">Your TYPO3 Version is beyond a currently released version, so you may run into some issue since we do not support this version yet.</span>
        </f:if>
        <f:if condition="!{is8orNewer}">
            <span class="text-danger">Your TYPO3 Version is very old, TV+ 8 does not support this version anymore. Please use the latest TV+ 7 version instead. Hopefully you are running an ELTS Version of TYPO3.</span>
        </f:if>
        <f:if condition="{is8orNewer} && !{is9orNewer}">
            <span class="text-warning">Your TYPO3 Version is supported by TV+ 8, but please see the message box below.</span>
        </f:if>
        <f:if condition="{is9orNewer} && !{is12orNewer}">
            <span class="text-success">Your TYPO3 Version is supported by TV+ 8.</span>
        </f:if>
    </p>

    <f:if condition="!{is9orNewer}">
        <f:be.infobox title="You are using a TYPO3 v8 release" state="1">
            <ul>
                <li>Your version of TYPO3 is out of normal maintenance support as of March 31, 2020. You should upgrade to a newer version of TYPO3 or pay to get extended maintenance support time (ELTS Support). For more information follow this <a href="https://typo3.com/products/extended-support" target="_blank" style="text-decoration: underline dotted red">link</a>. If you need more information on the support times of the TYPO3 versions, take a look <a href="https://typo3.org/cms/roadmap" target="_blank" style="text-decoration: underline dotted red">here</a>.</li>
                <li>However, even if you upgrade to TYPO3 v8, it still doesn't have the "Site Management" feature since it was introduced in "TYPO3 v9". So, unfortunately this feature isn't usable together with TemplaVoilà! Plus 8.</li>
            </ul>
        </f:be.infobox>
    </f:if>

    <h3 class="text-notice">Information</h3>
    <p class="lead">After upgrading your TYPO3 or your TV+ extension you may need to also run this update scripts so the structure of your data can also be updated to latest requirements. Partially this can be done while you run the TYPO3 Upgrade Wizards but mostly you will find them here, as TV+ wants to guide you through the update process with multiple steps and give you some natty informations. But, before you run any of the update scripts, we recommand to backup all your data of your TYPO3 instance. The update scipts are tested, but nobody knows if it works with your data and doesn't produce little hobbits which will run on your website afterwards.</p>
    <p class="lead">Every update script has its own version numbers, some can run multiple times, some may fanish and come back with later versions or if you installed other extensions. But you should <b>NEVER</b> run a database deletion task before you run all possible update scripts which you got presented (This is also valid for other extensions).</p>
    <f:be.infobox title="Warning" state="2">
        <ul>
            <li>Please backup your data before running any of the update scripts!</li>
            <li>Do not run any database deletion tasks until all possible update scripts have been completed!</li>
        </ul>
    </f:be.infobox>

    <h3>Please select an update script</h3>

    <f:comment>@TODO Add check if it needs to be run</f:comment>
    <f:be.infobox title="You need to run this to update your configuration to be compatible with TemplaVoilà! Plus 8" state="-1" disableIcon="true">
        <f:link.action controller="Backend\ControlCenter\Update\TemplaVoilaPlus8" action="stepStart" class="btn btn-primary btn-block btn-lg"><core:icon identifier="{f:if(condition: '{is9orNewer}', then: 'actions-play', else: 'actions-view-go-forward')}" /> Update configuration to TemplaVoilà! Plus 8 <small><small>(Version: 0.0.2)</small></small></f:link.action>
    </f:be.infobox>

    <f:be.infobox title="You should run this, to fix the TYPO3 TCA Changes between TYPO3 v7 LTS and v8/v9 LTS" state="{f:if(condition: '{is8orNewer}', then: '-1', else: '-2')}" disableIcon="true">
        <f:link.action controller="Backend\ControlCenter\Update\DataStructureV8" action="stepStart" class="btn btn-info btn-block btn-lg {f:if(condition: '!{is8orNewer}', then: 'disabled')}">
            <f:if condition="{is8orNewer}">
                <f:then>
                    <core:icon identifier="{f:if(condition: '{is9orNewer}', then: 'actions-play', else: 'actions-view-go-forward')}" />
                </f:then>
                <f:else>
                    <core:icon identifier="{f:if(condition: '{is9orNewer}', then: 'actions-ban', else: 'actions-close')}" />
                </f:else>
            </f:if>
            Update DataStructure from TYPO3 v7 LTS to v8/v9 LTS <small><small>(Version: 1.0.0)</small></small>
        </f:link.action>
    </f:be.infobox>

    <f:be.infobox title="You should run this, to fix the TYPO3 TCA Changes between TYPO3 v9 LTS and v10 LTS" state="{f:if(condition: '{is10orNewer}', then: '-1', else: '-2')}" disableIcon="true">
        <f:link.action controller="Backend\ControlCenter\Update\DataStructureV10" action="stepStart" class="btn btn-info btn-block btn-lg {f:if(condition: '!{is10orNewer}', then: 'disabled')}">
            <f:if condition="{is10orNewer}">
                <f:then>
                    <core:icon identifier="{f:if(condition: '{is9orNewer}', then: 'actions-play', else: 'actions-view-go-forward')}" />
                </f:then>
                <f:else>
                    <core:icon identifier="{f:if(condition: '{is9orNewer}', then: 'actions-ban', else: 'actions-close')}" />
                </f:else>
            </f:if>
            Update DataStructure from TYPO3 v9 LTS to v10 LTS <small><small>(Version: 1.0.0)</small></small>
        </f:link.action>
    </f:be.infobox>

    <f:be.infobox title="You should run this, to fix the TYPO3 TCA Changes between TYPO3 v10 LTS and v11 LTS" state="{f:if(condition: '{is11orNewer}', then: '-1', else: '-2')}" disableIcon="true">
        <f:link.action controller="Backend\ControlCenter\Update\DataStructureV11" action="stepStart" class="btn btn-info btn-block btn-lg {f:if(condition: '!{is11orNewer}', then: 'disabled')}">
            <f:if condition="{is11orNewer}">
                <f:then>
                    <core:icon identifier="{f:if(condition: '{is9orNewer}', then: 'actions-play', else: 'actions-view-go-forward')}" />
                </f:then>
                <f:else>
                    <core:icon identifier="{f:if(condition: '{is9orNewer}', then: 'actions-ban', else: 'actions-close')}" />
                </f:else>
            </f:if>
            Update DataStructure from TYPO3 v10 LTS to v11 LTS <small><small>(Version: 1.0.0)</small></small>
        </f:link.action>
    </f:be.infobox>
</div>
